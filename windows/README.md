## ime_toggle.ahk

Shift+Spaceで日本語・英語を切り替えるAutoHotKey設定。
ChatGPTに聞いて作成しました([会話ログリンク](https://chatgpt.com/share/6907d288-f200-8002-b6fd-8c941da20a8a))。

### 前提

前提としては、おそらく、

- US配列キーボード
- 日本語と英語の言語パックをインストールしている

ことだと思います。
JIS配列を利用している場合は、前述のChatGPTの履歴を参考に聞きなおしてみて下さい。

履歴にある通り、VSCode以外のアプリケーションでは、日本語IME機能のひらがなと半角英数切り替えがうまく動いていたのですが、VSCodeだけうまく動作しませんでした。
VSCodeに対応させるため、言語の切り替えで日本語と英語入力を切り替える方式になっています。
(そのため、おそらく両方の言語パックインストールが前提になっていると思います。私の環境は元から両方インストールしていたので、本当に必須なのか検証できていません)

### セットアップ

[AutoHotKey](https://www.autohotkey.com/) v2 をダウンロードしインストール。
その後、 `*.ahk` ファイルをダブルクリックすれば有効化されます。

ログオン時、管理者権限で有効化するようにするには:

1. Winキー → 「タスクスケジューラ」と入力 → 起動
2. 右側の「操作」ペインから ［タスクの作成］ をクリック
3. 以下のように設定します：

| タブ         | 設定項目                    | 値                                                                       |
| ------------ | --------------------------- | ------------------------------------------------------------------------ |
| **全般**     | 名前                        | `AutoHotkey IME Toggle` など適当                                         |
|              | 「最上位の特権で実行する」  | ✅ チェック（＝管理者権限で実行）                                        |
|              | 構成対象                    | 「Windows 11」                                                           |
| **トリガー** | 新規 → 「ログオン時」       | ✅ 有効                                                                  |
| **操作**     | 新規 → 「プログラムの開始」 |                                                                          |
|              | プログラム／スクリプト      | `C:\Program Files\AutoHotkey\v2\AutoHotkey.exe`（またはインストール先）  |
|              | 引数の追加                  | `"C:\Users\<ユーザー名>\Documents\AutoHotkey\ime_toggle.ahk"`            |
|              | 開始場所                    | スクリプトのフォルダ（例：`C:\Users\<ユーザー名>\Documents\AutoHotkey`） |
| **設定**     | タスクを停止するまでの時間  | チェックを外す                                                           |

4. 設定完了後、「OK」をクリック。管理者パスワードの入力を求められたら入力します。
5. 次回の Windows ログオン時、自動で AHK が管理者権限で起動します。
